<!DOCTYPE html>
<!-- Preliminaries • 5-DOF Rocket Simulation Tutorial -->
<html lang="en" x-data="guRocketryApp" :class="{ dark: darkMode }">
  <head>
 <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-40JDE37SXF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-40JDE37SXF');
</script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Preliminaries • 5-DOF Rocket Simulation</title>

    <!-- Fonts & core CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=typography,aspect-ratio"></script>
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <style>
    :root {
      --rocket-red: #ff3131;
      --earth-brown: #8b5e3c;
      --gcu-blue: #005EB8;
      --gcu-blue-light: #66B2FF;
      --text-white: #ffffff;
      --bg-dark: #0A192F;
      --bg-mid: #112240;
    }
    body { font-family: 'Inter', sans-serif; }

    .accent-red   { color: var(--rocket-red); }
    .accent-brown { color: var(--earth-brown); }
    .accent-blue  { color: var(--gcu-blue); }

    .cta-btn {
      display: inline-block;
      margin-top: 2rem;
      padding: .75rem 1.5rem;
      border-radius: .5rem;
      background-color: var(--rocket-red);
      color: var(--text-white);
      font-weight: 600;
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1),
                  0 4px 6px -2px rgba(0,0,0,0.05);
      transition: opacity 0.2s;
    }
    .cta-btn:hover { opacity: .9; }

    /* ★ star-field canvas */
    #starfield {
      position: fixed; inset: 0;
      background: #000; z-index: -1;
      touch-action: none;
    }

    [x-cloak] { display: none !important; }
  </style>

    <!-- ★★ star-field styles (new) -->
    <style>#starfield{position:fixed;inset:0;z-index:-1;background:#000;touch-action:none}</style>
    <style>[x-cloak] { display: none !important; }</style>

    <!-- AOS init -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        AOS.init({ duration: 800, once: true });
      });
    </script>

    <!-- Starfield background style -->
    <style>
      #starfield { position: fixed; inset: 0; z-index: -1; background: #000; touch-action: none; }
    </style>
    <style>[x-cloak] { display: none !important; }</style>

  </head>
  <body class="bg-white dark:bg-gray-950 text-gray-900 dark:text-white antialiased scroll-smooth">

    <!-- ★ star-field canvas -->
    <canvas id="starfield"></canvas>

    <!-- Navigation Bar -->
   <header class="fixed top-0 left-0 w-full z-50 bg-[color:var(--gcu-blue)] text-white shadow" x-data="{ open: false }">
    <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
   <nav class="hidden md:flex space-x-6 text-sm font-semibold">
  <!-- Anchors (same-page sections) -->
  <a href="index.html#mission" class="hover:text-red-500 transition">Home</a>



  <!-- External Pages -->
  <a href="MeetTeam.html" class="hover:text-[color:var(--gcu-blue-light)] transition">Team</a>
  <a href="Events.html" class="hover:text-[color:var(--gcu-blue-light)] transition">Events</a>
  <a href="certification.html" class="hover:text-[color:var(--gcu-blue-light)] transition">Certification</a>
"
</nav>
<!-- mobile burger -->
<button @click="open = !open" class="md:hidden text-gray-100">
  <template x-if="!open">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" stroke="currentColor">
      <path stroke-linecap="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
  </template>
  <template x-if="open">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" stroke="currentColor">
      <path stroke-linecap="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
    </svg>
  </template>
</button>


      <!-- mobile drawer -->
<!-- mobile drawer -->
<div
  x-show="open"
  x-cloak
  x-transition:enter="transition ease-out duration-300"
  x-transition:enter-start="opacity-0 -translate-y-4"
  x-transition:enter-end="opacity-100 translate-y-0"
  x-transition:leave="transition ease-in duration-200"
  x-transition:leave-start="opacity-100 translate-y-0"
  x-transition:leave-end="opacity-0 -translate-y-4"
  class="md:hidden bg-gray-900 border-t border-gray-800"
>
  <ul class="flex flex-col items-center py-6 gap-6 text-lg font-semibold text-white dark:text-gray-200">
    <li><a href="index.html"             @click="open=false" class="hover:text-[color:var(--gcu-blue-light)]">Home</a></li>
    <li><a href="MeetTeam.html"    @click="open = false" class="text-white hover:text-[color:var(--gcu-blue-light)]">Team</a></li>
    <li><a href="Events.html"            @click="open=false" class="hover:text-[color:var(--gcu-blue-light)]">Events</a></li>
    <li><a href="certification.html"     @click="open=false" class="hover:text-[color:var(--gcu-blue-light)]">Certifications</a></li>
  </ul>
</div>

    </header>

    <!-- Hero Section -->
    <section class="pt-28 pb-20 bg-gradient-to-b from-black to-gray-900 text-center relative overflow-hidden">
      <img src="../assets/preliminaries/preliminaries_hero.jpg" alt="" class="absolute inset-0 w-full h-full object-cover opacity-20 pointer-events-none" />
      <div class="relative z-10 max-w-4xl mx-auto px-4" data-aos="zoom-in">
        <h1 class="text-4xl md:text-5xl font-extrabold mb-3 accent-blue">Preliminaries</h1>
        <p class="text-gray-300 max-w-2xl mx-auto">
          Foundational dynamics, modelling assumptions &amp; control-theory concepts behind
          the 5-DOF rocket simulation and (coming soon) SCvx controller.
        </p>
      </div>
    </section>

    <!-- Sidebar Table of Contents (Desktop) -->
 <!-- Sidebar Table of Contents (Desktop) -->
<aside class="hidden lg:block fixed top-40 left-8 space-y-2 text-sm text-gray-700 dark:text-gray-300">
  <div class="text-gray-500 dark:text-gray-400 uppercase font-semibold mb-1">On this page</div>
  <a href="#mathematical-formulation" class="block hover:text-[color:var(--rocket-red)]">Mathematical Formulation</a>
  <a href="#rocket-problem" class="block hover:text-[color:var(--rocket-red)]">The Rocket Problem</a>
  <a href="#quatintro" class="block hover:text-[color:var(--rocket-red)]">Orientation (Frames)</a>
  <a href="#non-linear-physics" class="block hover:text-[color:var(--rocket-red)]">Non-Linear Physics</a>
  <a href="#aerodynamics" class="block hover:text-[color:var(--rocket-red)]">Aerodynamic Forces</a>
  <a href="#tvc" class="block hover:text-[color:var(--rocket-red)]">Thrust Vector Control</a>
  <a href="#references" class="block hover:text-[color:var(--rocket-red)]">References</a>
</aside>

<!-- Main Content -->
<main class="max-w-4xl mx-auto px-6 py-16 text-white text-base leading-relaxed space-y-16">

  <section class="prose dark:prose-invert max-w-none">

    <!-- 4.1 -->
    <h2 id="mathematical-formulation">4 · Mathematical Formulation</h2>
    <div class="my-8 flex justify-center" data-aos="fade-up">
      <img src="Figures/simulationimage.png" alt="Overall 5-DOF rocket simulation schematic" class="rounded border border-gray-700 dark:border-gray-300">
    </div>
    <p>
      The thrust-vector-controlled rocket is modelled as a rigid body with five active degrees of freedom (5-DOF). That is, the rocket can translate in 3D space and rotate about pitch and yaw, with roll neglected. The following nonlinear differential equations describe the rocket's dynamics:
    </p>
    <pre><code>q̇ = ½ q ⊗ ω
v̇<sub>i</sub> = F<sub>i</sub> / m
ω̇ = J⁻¹ (τ − ω × Jω)</code></pre>
    <p>
      Where <code>q</code> is the quaternion orientation, <code>ω</code> is angular velocity in the body frame, <code>F<sub>i</sub></code> is total force in inertial space, and <code>τ</code> is total torque. These equations are integrated at each time step to evolve the system.
    </p>

    <!-- 4.2 -->
    <h2 id="rocket-problem">4 · The Rocket Problem</h2>
    <h3>4.2.1 Simulation Requirements</h3>
    <p>
      The simulation must support full-body dynamics with control-relevant fidelity. The rocket considered here is on the scale of a model rocket (not orbital-class), justifying assumptions outlined below. Maneuvers include pitch/yaw turns requiring accurate aero and thrust dynamics, and OpenRocket will be used for simulation validation.
    </p>

    <h3>4.2.2 Assumptions</h3>
    <ul>
      <li>Rigid, axisymmetric airframe (no roll or flex).</li>
      <li>Mass and inertia constant (small propellant mass).</li>
      <li>Flat Earth (no Coriolis or rotation).</li>
      <li>Constant air density (1.225 kg/m³).</li>
      <li>Lateral wind modeled as a fixed sinusoidal profile.</li>
    </ul>
    <p>
      These simplify dynamics for early-stage control prototyping. Next, we define how orientation is tracked.
    </p>

    <h2 id="quatintro">Introducing Orientation Using Body and Inertial Frames</h2>
    <p>
      A 5DOF model requires orientation in space. This is tracked using the body frame (attached to the rocket) and the inertial frame (fixed to Earth). These are visualized below:
    </p>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
      <img src="Figures/bodyinInertial.png" alt="Body in inertial frame" class="rounded border border-gray-700 dark:border-gray-300">
      <img src="Figures/referenceFrames.png" alt="Reference frame axes" class="rounded border border-gray-700 dark:border-gray-300">
    </div>

    <p>
      Aerodynamic forces act in the body frame. Wind acts in the inertial frame. Quaternion orientation is used to rotate between these efficiently and avoid gimbal lock.
    </p>

    <img src="Figures/axisAngle.png" alt="Quaternion vs axis-angle" class="rounded border border-gray-700 dark:border-gray-300">

    <h3>Quaternion Transformation</h3>
    <p>
      Quaternion-based orientation is numerically stable, compact, and avoids gimbal lock. It has the property:
    </p>

    <pre><code>
v_i = q* ⊗ v_b ⊗ q
v_b = q ⊗ v_i ⊗ q*
    </code></pre>

    <p>
      Where <code>q</code> is the quaternion, <code>q*</code> its conjugate, and <code>⊗</code> denotes quaternion multiplication. This enables conversion of velocity vectors between frames.
    </p>

    <pre><code>
v_b = q ⊗ v_i ⊗ q* = R<sub>i,b</sub> · v_i
    </code></pre>

    <pre><code>
R<sub>i,b</sub> =
[[q₀² + q₁² − q₂² − q₃², 2(q₁q₂ − q₀q₃), 2(q₁q₃ + q₀q₂)],
 [2(q₁q₂ + q₀q₃), q₀² − q₁² + q₂² − q₃², 2(q₂q₃ − q₀q₁)],
 [2(q₁q₃ − q₀q₂), 2(q₂q₃ + q₀q₁), q₀² − q₁² − q₂² + q₃²]]
    </code></pre>

    <p>
      The transpose <code>R<sub>b,i</sub> = R<sub>i,b</sub><sup>T</sup></code> performs the reverse.
    </p>

    <h2 id="non-linear-physics">Describing the Relevant Non-Linear Physics</h2>
    <h3>Coupled Differential Equations</h3>

    <pre><code><b>Translation:</b>
v̇<sub>i</sub> = f<sub>i</sub> / m

<b>Rotation:</b>
ω̇ = J⁻¹ (τ − ω × Jω)
    </code></pre>

    <ul>
      <li><code>J</code>: Diagonal inertia matrix.</li>
      <li><code>ω × Jω</code>: Gyroscopic coupling.</li>
    </ul>

    <p>Neglecting roll simplifies rotation to:</p>

    <pre><code>ω̇ = J⁻¹ τ</code></pre>

    <p>Orientation is updated via quaternion kinematics:</p>

    <pre><code>q̇ = ½ · Ω(ω) · q</code></pre>

    <p>Where <code>Ω(ω)</code> is a skew-symmetric matrix. These equations form the simulation’s state update.</p>

  </section>
  <section class="prose dark:prose-invert max-w-none">

    <h3 id="aerodynamics">Aerodynamics: Squared Terms &amp; Trigonometric Non-Linearities</h3>

    <p>
      Aerodynamic forces couple translational and rotational dynamics and depend heavily on coefficients like <code>cₙ</code> (normal force) and <code>cₘ</code> (moment coefficient). At low angles of attack (AoA), these forces are linear and derived using slender body theory <cite>[Barrowman, 1967]</cite>.
    </p>

    <p>
      At higher AoA, non-linearities emerge and require empirical correction factors <cite>[Niskanen, 2013]</cite>. Aerodynamic coefficients are assumed to act at the center of pressure (COP), and their effect varies with geometry and flow characteristics.
    </p>

    <p>
      The angles of attack <code>α</code> and sideslip <code>β</code> are defined as:
    </p>

    <img src="Figures/alphaBeta.png" alt="Angle of attack and sideslip" class="rounded border border-gray-700 dark:border-gray-300 my-6">

    <pre><code>
<b>Equation (alpsid):</b>
α = arctan(w / u)
β = arctan(v / √(u² + w²))
    </code></pre>

    <ul>
      <li><code>u</code>: forward velocity (x-body),</li>
      <li><code>v</code>: lateral velocity (y-body),</li>
      <li><code>w</code>: vertical velocity (z-body).</li>
    </ul>

    <p>
      The resulting aerodynamic forces in the body frame are:
    </p>

    <pre><code>
<b>Equation (forcess):</b>
fₙ = q_dyn · cₙ · A_ref
fₛ = q_dyn · cₛ · A_ref
f_d = q_dyn · c_d · A_ref
    </code></pre>

    <ul>
      <li><code>q_dyn = ½ · ρ · v₀²</code>: dynamic pressure,</li>
      <li><code>cₙ</code>, <code>cₛ</code>, <code>c_d</code>: aerodynamic coefficients,</li>
      <li><code>A_ref</code>: reference cross-sectional area.</li>
    </ul>

    <img src="Figures/forcesCPCG.png" alt="Aerodynamic forces and CG/COP" class="rounded border border-gray-700 dark:border-gray-300 my-6">

    <p>
      Moments are generated when forces act off-center. Neglecting roll, the aerodynamic torque becomes:
    </p>

    <pre><code>
<b>Equation (torque):</b>
τ = q_dyn · c_M · A_ref · d
    </code></pre>

    <ul>
      <li><code>c_M</code>: net moment coefficient,</li>
      <li><code>d</code>: reference length (e.g., diameter).</li>
    </ul>

    <p>
      The moment coefficient combines static and damping terms:
    </p>

    <pre><code>
<b>Equation (summed):</b>
c_M = c_m,damp + c_m

<b>Equation (moment):</b>
c_m = cₙ · d / l_ref
    </code></pre>

    <ul>
      <li><code>l_ref</code>: moment arm (COG to COP).</li>
    </ul>

    <p>
      A damping term is added to reduce angular overshoot, especially near apogee:
    </p>

    <pre><code>
<b>Equation (damp):</b>
c_m,damp = 0.55 · (l_ref⁴ / A_ref) · (r_t / d) · (ω² / v₀²)
    </code></pre>

    <ul>
      <li><code>r_t</code>: rocket radius.</li>
    </ul>

    <p>
      These forces and torques create the aerodynamic environment which the TVC must overcome.
    </p>

    <h3 id="tvc">Thrust Vector Control: Trigonometric Coupling of Translation &amp; Rotation</h3>

    <p>
      Thrust vector control (TVC) allows the motor to gimbal its thrust direction. This generates forces and moments by creating an offset vector between thrust line and center of gravity. The force vector in the body frame is:
    </p>

    <pre><code>
<b>Equation (tvc_forces):</b>

f<sub>TVC</sub> = f<sub>T</sub> ·
[
  cos(θ)·cos(ϕ)
 −sin(ϕ)
  sin(θ)
]

τ<sub>TVC</sub> = r<sub>tvc</sub> × f<sub>TVC</sub>
    </code></pre>

    <ul>
      <li><code>θ</code>: TVC pitch gimbal angle,</li>
      <li><code>ϕ</code>: TVC yaw gimbal angle,</li>
      <li><code>r<sub>tvc</sub></code>: vector from COG to nozzle exit,</li>
      <li><code>f<sub>T</sub></code>: thrust magnitude.</li>
    </ul>

    <img src="Figures/TVCDynamics.png" alt="Thrust vector control diagram" class="rounded border border-gray-700 dark:border-gray-300 my-6">

    <p>
      These TVC contributions are crucial for real-time control. In simulation, they are evaluated at every time step and fed into the dynamic integrator that predicts the next state.
    </p>

    <p>
      In the next section, we introduce nonlinear control strategies — particularly those robust to real-time constraints — and motivate the use of Successive Convexification (SCvx) as the solver behind our model predictive control (MPC) setup.
    </p>

  </section>
</main>

  <h2>References</h2>

  <ol class="list-decimal pl-4 space-y-2">
    
    <li>Serale, G., Fiorentini, M., Capozzoli, A., Bernardini, D., & Bemporad, A. <em>Model predictive control (MPC) for enhancing building and HVAC system energy efficiency: Problem formulation, applications and opportunities.</em> Energies, 11(3), 631, 2018.</li>

    <li>Goldsman, D., Nance, R. E., & Wilson, J. R. <em>A brief history of simulation revisited.</em> Proceedings of the 2010 Winter Simulation Conference, 567–574, 2010. DOI: <a href="https://doi.org/10.1109/WSC.2010.5679129">10.1109/WSC.2010.5679129</a></li>

    <li>Raychaudhuri, S. <em>Introduction to Monte Carlo simulation.</em> Proceedings of the 2008 Winter Simulation Conference, 91–100, 2008. DOI: <a href="https://doi.org/10.1109/WSC.2008.4736059">10.1109/WSC.2008.4736059</a></li>

    <li>Evans, G. E., & Jones, B. <em>The Application of Monte Carlo Simulation in Finance, Economics and Operations Management.</em> 2009 WRI World Congress on Computer Science and Information Engineering, 4, 379–383. DOI: <a href="https://doi.org/10.1109/CSIE.2009.703">10.1109/CSIE.2009.703</a></li>

    <li>MATLAB. <em>MATLAB.</em> The MathWorks, Natick, MA, vol. 9, 2012.</li>

    <li>Doyle, J. C., Francis, B. A., & Tannenbaum, A. R. <em>Feedback Control Theory.</em> Courier Corporation, 2013.</li>

    <li>Stevens, B. L., Lewis, F. L., & Johnson, E. N. <em>Aircraft Control and Simulation: Dynamics, Controls Design, and Autonomous Systems.</em> John Wiley & Sons, 2015.</li>

    <li>Heermann, D. W. <em>Computer-Simulation Methods.</em> Springer, 1990.</li>

    <li>Rose, D. <em>Rotation Quaternions, and How to Use Them.</em> <a href="http://danceswithcode.net/engineeringnotes/quaternions/quaternions.html" target="_blank" rel="noopener">danceswithcode.net</a>, 2015.</li>

    <li>Markley, F. L. <em>Unit Quaternion from Rotation Matrix.</em> Journal of Guidance, Control, and Dynamics, 31(2), 440–442, 2008.</li>

    <li>Danielson, C., Kloeppel, J., & Petersen, C. <em>Spacecraft Attitude Control Using the Invariant-Set Motion-Planner.</em> IEEE Control Systems Letters, 6, 1700–1705, 2021.</li>

    <li>Venkatesan, C. <em>Fundamentals of Helicopter Dynamics.</em> CRC Press, 2014.</li>

    <li>Barrowman, J. S. <em>The Practical Calculation of the Aerodynamic Characteristics of Slender Finned Vehicles.</em> 1967.</li>

    <li>Niskanen, S. <em>OpenRocket Technical Documentation.</em> Development of an Open Source Model Rocket Simulation Software, 11–13, 2013.</li>

    <li>dos Santos, P., & Oliveira, P. <em>ADCS Design for a Sounding Rocket with Thrust Vectoring.</em> Aerotecnica Missili & Spazio, 102(3), 257–270, Springer, 2023.</li>

    <li>Gregory, D. A. <em>Specific Impulse and Mass Flow Rate Error.</em> The 2004 NASA Faculty Fellowship Program Research Reports, 2005.</li>
  </ol>
</section>

    <!-- Starfield JS (Canvas Animation) -->
    <script>
      const c = document.getElementById('starfield'), g = c.getContext('2d'),
            D = window.devicePixelRatio || 1,
            layers = [[70, 0.06, 1.6], [120, 0.03, 1.1], [160, 0.015, 0.8]];
      let W, H, stars = [], mx = 0, my = 0;
      const resize = () => {
        W = c.width = innerWidth * D;
        H = c.height = innerHeight * D;
        g.scale(D, D);
        stars = [];
        layers.forEach(([count, speed, size]) => {
          for (let i = 0; i < count; i++) {
            stars.push({
              x: Math.random() * innerWidth,
              y: Math.random() * innerHeight,
              speed,
              size
            });
          }
        });
      };
      const step = (timestamp) => {
        if (lastTimestamp === undefined) lastTimestamp = timestamp;
        const elapsed = timestamp - lastTimestamp;
        lastTimestamp = timestamp;
        g.fillStyle = '#000';
        g.fillRect(0, 0, innerWidth, innerHeight);
        for (const star of stars) {
          star.x += star.speed * mx * elapsed;
          star.y += star.speed * my * elapsed;
          if (star.x < 0) star.x += innerWidth;
          if (star.x > innerWidth) star.x -= innerWidth;
          if (star.y < 0) star.y += innerHeight;
          if (star.y > innerHeight) star.y -= innerHeight;
          g.fillStyle = 'rgba(255,255,255,' + star.size + ')';
          g.fillRect(star.x, star.y, star.size * 2, star.size * 2);
        }
        requestAnimationFrame(step);
      };
      let lastTimestamp;
      window.addEventListener('mousemove', (e) => {
        mx = (e.clientX / innerWidth - 0.5) * 2;
        my = (e.clientY / innerHeight - 0.5) * 2;
      });
      window.addEventListener('resize', resize);
      resize();
      requestAnimationFrame(step);
    </script>

  </body>
</html>
